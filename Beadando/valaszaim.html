<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>V√°laszaim √©s tervem</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <!-- jsPDF CDN -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>

<div class="page">
    <header>
        <h1>V√°laszaim √©s tervem</h1>
        <p>Itt le√≠rod, melyik utat v√°lasztod, mit fogsz tenni, √©s mikor kezded el. A v√©g√©n let√∂ltheted PDF-ben.</p>
    </header>

    <main class="answers-container">

        <!-- 1. k√©rd√©s: munka / egyetem / egyik sem -->
        <section class="no-print">
            <h2 class="form-section-title">1. Melyik utat v√°lasztom most?</h2>

            <div class="form-group">
                <label class="radio-label">
                    <input type="radio" name="valasztott_ut" value="Munka">
                    Munka
                </label>
                <label class="radio-label">
                    <input type="radio" name="valasztott_ut" value="Egyetem">
                    Egyetem
                </label>
                <label class="radio-label">
                    <input type="radio" name="valasztott_ut" value="Egyik sem (otthoni tanul√°s / id≈ët adok magamnak)">
                    Egyik sem
                </label>
            </div>
        </section>

        <!-- 2. k√©rd√©s: ter√ºlet ‚Äì datalist -->
        <section class="no-print">
            <h2 class="form-section-title">2. Milyen ter√ºleten szeretn√©k a legink√°bb sikeres lenni?</h2>

            <div class="form-group">
                <input id="siker_terulet" list="siker-terulet-list" placeholder="pl. programoz√°s, grafika">
                <datalist id="siker-terulet-list">
                    <option value="Programoz√°s / IT"></option>
                    <option value="Grafika / design"></option>
                    <option value="Zene / hangtechnika"></option>
                    <option value="Vide√≥z√°s / YouTube"></option>
                    <option value="V√°llalkoz√°s"></option>
                    <option value="M√©g fogalmam sincs, de nagyot akarok menni"></option>
                </datalist>
            </div>
        </section>

        <!-- 3. k√©rd√©s: l√©p√©sek ‚Äì textarea -->
        <section class="no-print">
            <h2 class="form-section-title">3. Ezeket a l√©p√©seket fogom megtenni, hogy sikeres legyek.</h2>

            <div class="form-group">
                <textarea id="lepesek" placeholder="√çrd le konkr√©tan: mit fogsz csin√°lni? (pl. elk√ºld√∂k egy √∂n√©letrajzot, v√©gign√©zek egy leck√©t, felh√≠vok valakit...)"></textarea>
            </div>
        </section>

        <!-- 4. k√©rd√©s: egy soros input -->
        <section class="no-print">
            <h2 class="form-section-title">4. Ma ezt az egy dolgot biztosan megteszem:</h2>

            <div class="form-group">
                <input type="text" id="mai_lepes" placeholder="pl. elk√ºld√∂k egy √∂n√©letrajzot / v√©gign√©zek egy leck√©t">
            </div>
        </section>

        <!-- 5. k√©rd√©s: mikor kezdem el ‚Äì r√°di√≥gombok -->
        <section class="no-print">
            <h2 class="form-section-title">5. Mikor fogom elkezdeni?</h2>

            <div class="form-group">
                <p>V√°lasz: csak az els≈ë opci√≥ lesz val√≥ban v√°laszthat√≥. üòâ</p>

                <label class="radio-label">
                    <input type="radio" name="kezdes" value="Ma" checked>
                    Ma
                </label>

                <label class="radio-label" style="opacity: 0.5;">
                    <input type="radio" name="kezdes" value="Majd holnap" disabled>
                    Majd holnap
                </label>

                <label class="radio-label" style="opacity: 0.5;">
                    <input type="radio" name="kezdes" value="Majd k√©s≈ëbb" disabled>
                    Majd k√©s≈ëbb
                </label>

                <label class="radio-label" style="opacity: 0.5;">
                    <input type="radio" name="kezdes" value="T√∫l f√°radt vagyok üò¥" disabled>
                    T√∫l f√°radt vagyok üò¥
                </label>
            </div>
        </section>

        <!-- 6. k√©rd√©s: fogadalmak ‚Äì checkboxok -->
        <section class="no-print">
            <h2 class="form-section-title">6. Ezt ma beikszeltem magamnak:</h2>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="fog1">
                    V√°llalom, hogy nem halogatok feleslegesen.
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="fog2">
                    Elfogadom, hogy a d√∂nt√©seim√©rt √©n vagyok a felel≈ës.
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="fog3">
                    Legal√°bb egy embert megk√©rek, hogy n√©ha r√°k√©rdezzen, haladok-e.
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="fog4">
                    Kijelentem, hogy nem csak az√©rt kelek fel, hogy tov√°bb aludhassak. üò¥
                </label>
            </div>
        </section>

        <!-- 7. sz√≠nv√°laszt√≥ -->
        <section class="no-print">
            <h2 class="form-section-title">7. Milyen sz√≠nben l√°tom most a j√∂v≈ëmet?</h2>

            <div class="form-group">
                <p>A v√°lasztott sz√≠n≈± keret fog megjelenni a profilk√©ped k√∂r√ºl a PDF-ben.</p>
                <input type="color" id="jovo_szin" value="#ff8800">
            </div>
        </section>

        <!-- 8. d√°tumv√°laszt√≥ (≈±rlap-feladat miatt, PDF-ben m√°r nem haszn√°ljuk k√ºl√∂n) -->
        <section class="no-print">
            <h2 class="form-section-title">8. Eddig a napig szeretn√©m a c√©lom el√©rni:</h2>

            <div class="form-group">
                <input type="date" id="szerzodes_datum">
            </div>
        </section>

        <!-- Gombok -->
        <section class="no-print" style="margin-top: 20px;">
            <button type="button" id="pdf-button" class="pdf-button">
                V√°laszaim let√∂lt√©se PDF-ben
            </button>

            <button type="button" id="clear-answers" class="pdf-button" style="margin-left:10px;background:#4b5563;">
                V√°laszok t√∂rl√©se
            </button>

            <p class="pdf-help">
                A gomb egy PDF f√°jlt hoz l√©tre a v√°laszaidb√≥l (profilk√©ppel egy√ºtt), √©s let√∂lti a g√©pedre.
            </p>

            <p style="margin-top: 24px;">
                <a href="index.html" style="color:#93c5fd; text-decoration:none;">
                    ‚Üê Vissza a v√°laszt√≥ oldalra
                </a>
            </p>
        </section>

        <section id="print-summary" class="print-only"></section>

    </main>
</div>

<script>
    // profilk√©p
    let profileImageDataUrl = null;
    let profileImageRatio = 1; // height / width

    // al√°√≠r√°s k√©p
    let signatureImageDataUrl = null;
    let signatureImageRatio = 1;

    // hex -> RGB seg√©df√ºggv√©ny
    function hexToRgb(hex) {
        if (!hex) return null;
        hex = hex.replace('#', '');
        if (hex.length === 3) {
            hex = hex.split('').map(c => c + c).join('');
        }
        if (hex.length !== 6) return null;
        const num = parseInt(hex, 16);
        return {
            r: (num >> 16) & 255,
            g: (num >> 8) & 255,
            b: num & 255
        };
    }

    // ≈ë / ≈ê -> √∂ / √ñ
    function fixHungarian(text) {
        if (!text) return text;
        return text.replace(/≈ë/g, '√∂').replace(/≈ê/g, '√ñ');
    }

    document.addEventListener('DOMContentLoaded', function () {
        // PROFILK√âP EL≈êT√ñLT√âSE
        const imgProfile = new Image();
        imgProfile.src = 'kepek/levi.jpg'; // Levi arck√©pe
        imgProfile.onload = function () {
            const canvas = document.createElement('canvas');
            canvas.width = imgProfile.naturalWidth;
            canvas.height = imgProfile.naturalHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(imgProfile, 0, 0);
            profileImageDataUrl = canvas.toDataURL('image/jpeg');
            profileImageRatio = imgProfile.naturalHeight / imgProfile.naturalWidth;
        };

        // AL√Å√çR√ÅS K√âP EL≈êT√ñLT√âSE
        const imgSign = new Image();
        imgSign.src = 'kepek/alairas.png'; // Levi al√°√≠r√°sa
        imgSign.onload = function () {
            const canvas = document.createElement('canvas');
            canvas.width = imgSign.naturalWidth;
            canvas.height = imgSign.naturalHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(imgSign, 0, 0);
            signatureImageDataUrl = canvas.toDataURL('image/png');
            signatureImageRatio = imgSign.naturalHeight / imgSign.naturalWidth;
        };

        // d√°tum input alap√©rt√©k: mai nap (≈±rlap miatt)
        const dateInput = document.getElementById('szerzodes_datum');
        if (dateInput && !dateInput.value) {
            const d = new Date();
            const y = d.getFullYear();
            const m = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            dateInput.value = y + '-' + m + '-' + day;
        }

        function get(id) {
            var el = document.getElementById(id);
            return el ? el.value : '';
        }

        // PDF GOMB
        var btn = document.getElementById('pdf-button');
        if (!btn) return;

        btn.addEventListener('click', function () {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({
                orientation: 'p',
                unit: 'mm',
                format: 'a4'
            });

            // alap bet≈±t√≠pus: times (Times New Roman)
            doc.setFont('times', 'normal');

            const pageWidth  = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            let y = 20;

            const chosenColor = document.getElementById('jovo_szin') ? document.getElementById('jovo_szin').value : '#000000';
            const rgbColor = hexToRgb(chosenColor);

            // --- K√âP + N√âV + SZLOGEN K√ñZ√âPEN FEL√úL + SZ√çNES KERET ---
            if (profileImageDataUrl) {
                const imgWidth = 60; // nagyobb k√©p
                const imgHeight = imgWidth * profileImageRatio;
                const x = (pageWidth - imgWidth) / 2;
                const topY = 15;

                // keret
                if (rgbColor) {
                    doc.setDrawColor(rgbColor.r, rgbColor.g, rgbColor.b);
                    doc.setLineWidth(2.5);
                    doc.rect(x - 4, topY - 4, imgWidth + 8, imgHeight + 8);
                }

                // k√©p
                doc.addImage(profileImageDataUrl, 'JPEG', x, topY, imgWidth, imgHeight);

                // n√©v + szlogen (lejjebb, hogy ne √©rjen a kerethez)
                const nameY = topY + imgHeight + 16;
                const taglineY = nameY + 8;

                doc.setFont('times', 'bold');
                doc.setFontSize(18);
                doc.text(fixHungarian('Maros Levente'), pageWidth / 2, nameY, { align: 'center' });

                doc.setFont('times', 'normal');
                doc.setFontSize(14);
                doc.text(fixHungarian('siker√©nek titkai'), pageWidth / 2, taglineY, { align: 'center' });

                y = taglineY + 16;
            } else {
                doc.setFont('times', 'bold');
                doc.setFontSize(18);
                doc.text(fixHungarian('Maros Levente'), pageWidth / 2, 30, { align: 'center' });
                doc.setFont('times', 'normal');
                doc.setFontSize(14);
                doc.text(fixHungarian('siker√©nek titkai'), pageWidth / 2, 40, { align: 'center' });
                y = 56;
            }

            // --- 1. OLDAL SZ√ñVEGES R√âSZ (egy √∂sszef√ºgg≈ë elbesz√©l√©s) ---

            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');

            const dateText = `${year}.${month}.${day}.`;
            const timeText = `${hours}:${minutes}`;

            const selectedPath = document.querySelector('input[name="valasztott_ut"]:checked');
            let pathPhrase = 'egy saj√°t utat j√°rni';
            if (selectedPath) {
                const v = selectedPath.value || '';
                if (v.startsWith('Munka')) {
                    pathPhrase = 'munk√°ba √°llni';
                } else if (v.startsWith('Egyetem')) {
                    pathPhrase = 'egyetemre menni';
                } else {
                    pathPhrase = 'autodidakta m√≥don fejleszteni magam';
                }
            }

            let sikerTerulet = get('siker_terulet').trim();
            let sikerResz = '';
            if (sikerTerulet) {
                sikerResz = `, k√ºl√∂n√∂sen a(z) ${sikerTerulet} ter√ºlet√©n`;
            }

            const lepesekText = get('lepesek').trim();
            const maiLepesText = get('mai_lepes').trim();

            const paragraph1 =
                `√ân, Maros Levente, ${dateText} ${timeText}-kor a mai napon azt v√°lasztottam, ` +
                `hogy szeretn√©k ${pathPhrase}${sikerResz}.`;

            function writeParagraph(text, fontSize) {
                if (!text || !text.trim()) return;
                doc.setFont('times', 'normal');
                doc.setFontSize(fontSize);
                const maxWidth = pageWidth - 40; // 20-20 mm marg√≥
                const lines = doc.splitTextToSize(fixHungarian(text), maxWidth);
                lines.forEach(line => {
                    doc.text(line, 20, y);
                    y += fontSize * 0.45 + 3; // kb. 6‚Äì7 mm sor
                });
                y += 4;
            }

            // 1. bekezd√©s
            writeParagraph(paragraph1, 13);

            // 2. bekezd√©s: l√©p√©sek
            if (lepesekText) {
                const intro =
                    'Azt √≠rtam fel magamnak ezen a napon, ebben az √≥r√°ban, hogy ezeket fogom megtenni a siker √©rdek√©ben:';
                writeParagraph(intro, 13);

                const stepsLines = lepesekText.split(/\r?\n/).filter(l => l.trim() !== '');
                doc.setFont('times', 'normal');
                doc.setFontSize(12);
                const maxWidth = pageWidth - 46;

                stepsLines.forEach(line => {
                    const bullet = '- ' + line.trim();
                    const blines = doc.splitTextToSize(fixHungarian(bullet), maxWidth);
                    blines.forEach(bline => {
                        doc.text(bline, 26, y);
                        y += 6;
                    });
                });

                y += 6;
            }

            // 3. bekezd√©s: mai egy dolog
            if (maiLepesText) {
                const paragraph3 =
                    `Ma ezt az egy dolgot biztosan megteszem: ${maiLepesText}.`;
                writeParagraph(paragraph3, 13);
            }

            // --- AL√Å√çR√ÅS BLOKK AZ 1. OLDAL ALJ√ÅN, K√ñZ√âPEN ---

            doc.setPage(1); // biztosan az els≈ë oldalon rajzoljuk

            const bottomMargin = 22;
            const labelText = 'Maros Levente, a legsikeresebb ember al√°√≠r√°sa';

            if (signatureImageDataUrl) {
                const sigWidth  = 80;  // nagyobb al√°√≠r√°s
                const sigHeight = sigWidth * signatureImageRatio;
                const centerX = pageWidth / 2;

                const bottomTextY = pageHeight - bottomMargin;

                const sigY = bottomTextY - 8 - sigHeight;
                const topTextY = sigY - 8;

                // "A cs√∫cson tali." a k√©p f√∂l√∂tt
                doc.setFont('times', 'bold');
                doc.setFontSize(13);
                doc.text(fixHungarian('A cs√∫cson tali.'), centerX, topTextY, { align: 'center' });

                // al√°√≠r√°s k√©p
                const sigX = centerX - sigWidth / 2;
                doc.addImage(signatureImageDataUrl, 'PNG', sigX, sigY, sigWidth, sigHeight);

                // felirat a k√©p alatt
                doc.setFont('times', 'normal');
                doc.setFontSize(12);
                doc.text(fixHungarian(labelText), centerX, bottomTextY, { align: 'center' });
            } else {
                // ha nincs k√©p, legal√°bb a sz√∂vegek
                doc.setFont('times', 'bold');
                doc.setFontSize(13);
                doc.text(fixHungarian('A cs√∫cson tali.'), pageWidth / 2, pageHeight - 26, { align: 'center' });

                doc.setFont('times', 'normal');
                doc.setFontSize(12);
                doc.text(fixHungarian(labelText), pageWidth / 2, pageHeight - 14, { align: 'center' });
            }

            // --- 2. OLDAL: csak UT√ìIRAT ---

            doc.addPage();
            let y2 = 35;
            const maxWidth2 = pageWidth - 40;

            doc.setFont('times', 'bold');
            doc.setFontSize(18);
            doc.text(fixHungarian('Ut√≥irat:'), 20, y2);
            y2 += 14;

            doc.setFont('times', 'normal');
            doc.setFontSize(13);

            function writeParagraphPage2(text) {
                if (!text || !text.trim()) return;
                const lines = doc.splitTextToSize(fixHungarian(text), maxWidth2);
                lines.forEach(line => {
                    doc.text(line, 20, y2);
                    y2 += 7;
                });
                y2 += 5;
            }

            doc.text(fixHungarian('Kedves Levente,'), 20, y2);
            y2 += 10;

            const para1 =
                'Rem√©lem, hogy ezzel mosolyt csaltam az arcodra. Tudom, hogy sokan nyomnak ezzel T√©ged √©s √©n ezt nem azzal a sz√°nd√©kkal k√©sz√≠tettem, hanem, mint az unoka√∂cs√©m, fontos vagy sz√°momra √©s nagyon √©rt√©kes vagy √©s tele vagy k√©pess√©ggel √©s tehets√©ggel √©s mi hisz√ºnk benned.';
            writeParagraphPage2(para1);

            const para2 =
                'Szeretn√©k nagyon boldog, √°ldott √©s val√≥di sikerekben kar√°csonyt √©s √∫j√©vet k√≠v√°nni sz√°modra ezzel.';
            writeParagraphPage2(para2);

            const blessing1 =
                '√Åldjon meg t√©ged az √ör, √©s ≈ërizzen meg t√©ged! - 4 M√≥zes 6:24';
            writeParagraphPage2(blessing1);

            const blessing2 =
                '‚ÄûB√∂lcs√© teszlek √©s megtan√≠talak t√©ged az √∫tra, amelyen j√°rj; szemeimmel tan√°csollak t√©ged.‚Äù - Zsolt√°rok 32:8';
            writeParagraphPage2(blessing2);

            doc.text(fixHungarian('Szeretettel,'), 20, y2 + 2);
            y2 += 10;
            doc.text(fixHungarian('M√°rk unokab√°ty√°d'), 20, y2 + 2);

            // --- LET√ñLT√âS ---
            doc.save('valaszaim-maros-levente.pdf');
        });

        // --- V√ÅLASZOK T√ñRL√âSE GOMB ---
        const clearBtn = document.getElementById('clear-answers');
        if (clearBtn) {
            clearBtn.addEventListener('click', function () {
                // egy soros mez≈ëk
                const sikerTer = document.getElementById('siker_terulet');
                if (sikerTer) sikerTer.value = '';

                const maiLepesInput = document.getElementById('mai_lepes');
                if (maiLepesInput) maiLepesInput.value = '';

                // textarea
                const lepesek = document.getElementById('lepesek');
                if (lepesek) lepesek.value = '';

                // √∫tv√°laszt√≥ r√°di√≥k ‚Äì mind kikapcsolva
                document.querySelectorAll('input[name="valasztott_ut"]').forEach(r => r.checked = false);

                // "Mikor kezdem" r√°di√≥k ‚Äì vissza Ma √©rt√©kre
                const kezdesMa = document.querySelector('input[name="kezdes"][value="Ma"]');
                if (kezdesMa) kezdesMa.checked = true;

                // jel√∂l≈ën√©gyzetek
                ['fog1', 'fog2', 'fog3', 'fog4'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.checked = false;
                });

                // sz√≠nv√°laszt√≥ vissza alap√©rt√©kre
                const colorInput = document.getElementById('jovo_szin');
                if (colorInput) colorInput.value = '#ff8800';

                // d√°tum vissza a mai napra (≈±rlap miatt)
                if (dateInput) {
                    const d = new Date();
                    const y = d.getFullYear();
                    const m = String(d.getMonth() + 1).padStart(2, '0');
                    const day = String(d.getDate()).padStart(2, '0');
                    dateInput.value = `${y}-${m}-${day}`;
                }
            });
        }
    });
</script>

</body>
</html>
